<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>地震前 × 地震後 3DGS 比較（Supersplat埋め込み）</title>
<style>
  :root{
    --split:50%;   /* スライダー（%） */
    --alpha:1;     /* フェード用の不透明度 0〜1 */
    --accent:#2b7cff;
    --radius:12px;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:#0f1115;color:#e8e8e8;
    font-family:system-ui,-apple-system,"Hiragino Sans","Noto Sans JP",Roboto,sans-serif}
  header{padding:10px 12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .btn{border:1px solid #2a3142;background:#1b2232;color:#e8e8e8;border-radius:999px;padding:8px 12px;cursor:pointer}
  .btn.active{outline:2px solid var(--accent)}
  .wrap{position:relative;height:calc(100% - 56px);overflow:hidden}
  iframe{position:absolute;inset:0;width:100%;height:100%;border:0}
  /* 上レイヤー（地震後） */
  #now{clip-path:polygon(0 0, var(--split) 0, var(--split) 100%, 0 100%);opacity:var(--alpha)}

  .badge{position:absolute;top:12px;left:12px;background:#1b2232;border:1px solid #2a3142;
    border-radius:8px;padding:6px 8px;font-size:12px}
  .badge.r{left:auto;right:12px}
  .slider{
    position:absolute;left:0;right:0;bottom:12px;margin:auto;width:min(720px,92vw);
    background:#1b2232;border:1px solid #2a3142;border-radius:var(--radius);
    padding:10px 12px;display:flex;align-items:center;gap:10px;backdrop-filter:blur(6px)
  }
  .slider input[type="range"]{flex:1;accent-color:var(--accent)}
  .label{font-size:12px;opacity:.8}
</style>
</head>
<body>
  <header>
    <strong>地震前 × 地震後 3DGS 比較</strong>
    <button id="modeSplit" class="btn active" aria-pressed="true">スライダー</button>
    <button id="modeFade"  class="btn" aria-pressed="false">フェード</button>
    <button id="swap"      class="btn" title="上下レイヤーを入れ替え">入れ替え</button>
  </header>

  <div class="wrap" id="wrap" role="application" aria-label="3D比較ビュー">
    <!-- ↓↓↓ Supersplat公開URLに置き換え ↓↓↓ -->
    <iframe id="past" src="https://superspl.at/view?id=f60f2a84"></iframe>
    <iframe id="now"  src="https://superspl.at/view?id=7170d44a"></iframe>
    <!-- ↑↑↑ 置き換え ↑↑↑ -->

    <div class="badge">地震前</div>
    <div class="badge r">地震後</div>

    <div class="slider" id="slider">
      <span class="label" id="labelL">0%</span>
      <input id="range" type="range" min="0" max="100" value="50" step="1" aria-label="比較位置" />
      <span class="label" id="labelR">100%</span>
    </div>
  </div>

<script>
(() => {
  const root = document.documentElement;
  const range = document.getElementById('range');
  const modeSplit = document.getElementById('modeSplit');
  const modeFade  = document.getElementById('modeFade');
  const swapBtn   = document.getElementById('swap');
  const nowFrame  = document.getElementById('now');
  const pastFrame = document.getElementById('past');
  let isSplit = true;

  function setSplit(v){
    root.style.setProperty('--split', v+'%');
    root.style.setProperty('--alpha', 1);
  }
  function setFade(v){
    root.style.setProperty('--alpha', (v/100).toFixed(3));
  }
  range.addEventListener('input', e=>{
    const v = Number(e.target.value);
    if(isSplit) setSplit(v); else setFade(v);
  });

  function setMode(split){
    isSplit = split;
    modeSplit.classList.toggle('active', split);
    modeFade.classList.toggle('active', !split);
    if(split){
      setSplit(Number(range.value));
      nowFrame.style.clipPath = '';
      nowFrame.style.clipPath = `polygon(0 0, var(--split) 0, var(--split) 100%, 0 100%)`;
    }else{
      root.style.setProperty('--split', '100%'); // 全面表示に
      setFade(Number(range.value));
      nowFrame.style.clipPath = 'polygon(0 0, 100% 0, 100% 100%, 0 100%)';
    }
  }
  modeSplit.onclick = ()=> setMode(true);
  modeFade.onclick  = ()=> setMode(false);

  swapBtn.onclick = ()=>{
    const wrap = document.getElementById('wrap');
    wrap.insertBefore(nowFrame, pastFrame);
    wrap.insertBefore(pastFrame, wrap.firstChild);
    const [b1,b2] = wrap.querySelectorAll('.badge');
    [b1.textContent, b2.textContent] = [b2.textContent, b1.textContent];
  };

  // 初期
  setSplit(50);
})();
</script>
</body>
</html>
